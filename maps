"
" scott@smemsh.net
" http://smemsh.net/src/.vim/
" http://spdx.org/licenses/GPL-2.0.html
"
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" change fold levels
"
nmap <leader><leader>f :set foldlevel+=1<return>
nmap         <leader>f :set foldlevel-=1<return>

" auto-format +/-
"
nmap <leader><leader>a :set formatoptions+=a<return>
nmap         <leader>a :set formatoptions-=a<return>

" wrap toggle
"
nmap         <leader>w :set wrap nolist showbreak=""<return>
nmap <leader><leader>w :set nowrap list showbreak="> "<return>

" buffer manipulations
"
nmap <c-j> <c-w>j
nmap <c-k> <c-w>k
nmap <c-y> <c-w>p
nmap <c-n> :bn<return>
nmap <c-p> :bp<return>
"nnoremap <leader>l :ls<return>
nmap <leader>l <leader>be
nnoremap <leader>. :b#<return>

" c-l has to be redraw; it is a commandment from the unix
" god (sharing the prominance of c-z or c-c).  this means
" that the we cannot complete the desired mapping: 'control'
" key grid reserves is missing a right (key 'l', ie "advance
" to next whatever") in teh one dimension of the two
" available in the vi interface paradigm (the corresponding
" remaining one being "analogous
"
" see if having commented this out causes great pain and
" frustration, and fix/replace with some other key combo if
" needed
"
" XXX TODO think fixed using c-[np] and then moving c-w,p to c-y
" erase this comment block once confirmed

" temporal undo maps
" (note: '=' map replaces "filter through 'equalprog' or cindent")
"
nmap - g-
nmap + g+
nmap = g+

" temporary solution to having nonfunctioning F-keys
noremap <f1> <c-^>
noremap <c-^> <f1>

" for editing raw text/flowed style microsoft one-line paragraphs
nmap <leader>v :set fo-=a tw=0 nolist wrap lbr sbr=<return>
	\:match WarningMsg ''<return> :24vspl /dev/null<return>

" clear settings
nmap <leader>c :set noai nosi nocin tw=0 fo-=a indentexpr=<return>
nmap <leader>5 :set tw=55<return>
nmap <leader>6 :set tw=60<return>
nmap <leader>7 :set tw=72<return>
nmap <leader>0 :set tw=0<return>

" screen redraw
"
nmap <leader><leader>l :redraw!<return>
nmap <c-l> :redraw!<return>

" sometimes use these settings to edit outlines
"
nmap <leader>o
	\:set ts=4 sw=4 noexpandtab indentexpr=<return>

""" APPLICATIONS """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" for editing Trac wiki RST
"
map <leader><leader>r
	\:set fo-=a<return>
	\a{{{<return>#!rst<return><return><return><return>}}}
	\<esc>kka<esc>
	\:set ft=rst<return>
	\:set nospell<return>
	\:set tw=72<return>
	\:set fo-=a<return>
	\i

map <leader>r
	\:set nospell<return>
	\:set ft=rst<return>

map <leader>q m`WBi``<esc>Ea``<esc>`` | " quote
nmap <leader><leader>9 a`#99999`:trac:<esc>

" mutt signatures with and without the horiz underline
"
nmap ,,s ,c0o--<space><return>Scott<esc>
nmap ,,S ,,sa<return><return><esc>78i_<esc>A<return><esc>
nmap ,,o ,c0o--<space><esc>:read<space>~/.mutt/signature.omnisys<return><esc>
nmap ,,O ,c0,,o}A<return><esc>78i_<esc>A<return><esc>


""" TRICKS """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

" awesome history window, editable same as a buffer!
" sometimes messages do not show up; use q: in that case
"
if ! &compatible
	nnoremap q: :
	nnoremap : q:
	autocmd CmdwinEnter [:/?] startinsert
endif

" diff this buffer against the pristine version and use
" split screen to show differences, of course will look
" better on larger screen
"
if ! exists(":DiffOrig")
command DiffOrig
	\ vert new		|
	\ set bt=nofile		|
	\ r #			|
	\ 0d_			|
	\ diffthis		|
	\ wincmd p		|
	\ diffthis
nmap <leader>d :DiffOrig<return>
endif

" type while inserting, inputs the date, and then continues
" appending in insert mode after going to the end of the new
" date
"
map! <leader><leader>d <ESC>:call Read_shell_histtimeformat()<CR>Ea 

" to tabs (T), to spaces (t)
"
nmap <leader>t :set expandtab<return> :retab!<return>
nmap <leader>T :set noexpandtab<return> :retab!<return>

" toggle understanding of numerics to auto-formatting
"
nmap <leader>N :set fo+=n<return>
nmap <leader>n :set fo-=n<return>
